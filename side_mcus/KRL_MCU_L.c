#include <avr/io.h>
#include <avr/interrupt.h>
#include <lib/delay.h>

#define DDR_SPI DDRB
#define DD_MOSI PB5
#define DD_SCK PB7
#define DD_SS PB4
#define DD_MISO PB6

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//ZMIENNE/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//ZMIENNNE WEJSC
int  PIETRO_0_WEJSCIE=0;
int  PIETRO_1_WEJSCIE=0;
int  PIETRO_2_WEJSCIE=0;
int  PIETRO_3_WEJSCIE=0;
int  PIETRO_4_WEJSCIE=0;
int  PIETRO_5_WEJSCIE=0;
int  PIETRO_6_WEJSCIE=0;
int  PIETRO_7_WEJSCIE=0;
int  PIETRO_8_WEJSCIE=0;
int  PIETRO_9_WEJSCIE=0;
int PIETRO_10_WEJSCIE=0;
//KONIEC ZMIENNYCH WEJSC

//ZMIENNE WYSJC
int  PIETRO_0_WYJSCIE=0;
int  PIETRO_1_WYJSCIE=0;
int  PIETRO_2_WYJSCIE=0;
int  PIETRO_3_WYJSCIE=0;
int  PIETRO_4_WYJSCIE=0;
int  PIETRO_5_WYJSCIE=0;
int  PIETRO_6_WYJSCIE=0;
int  PIETRO_7_WYJSCIE=0;
int  PIETRO_8_WYJSCIE=0;
int  PIETRO_9_WYJSCIE=0;
int PIETRO_10_WYJSCIE=0;
//KONIEC ZMIENNCYH WYSJC
/*
//ZMIENNE PRZESYLANIA
int WOLNY=0;
int TRAN=0;
int STARY_TRAN=0;
int KONIEC=0;
int STARY_WY=0;
int WY=0;
int STARY_WE=0;
int WE=0;
//int WY=0;
int NUMER=0;
int CZAS=1; //spokojnie dziala na 50
//KONIEC ZMIENNYCH PRZESYLANIA
*/
//ZMIENNE TEMP
int P0=0;
int P1=0;
int P2=0;
int P3=0;											//DODAC WYSYLANIE DYSPOZYCJI!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
int P4=0;
int P5=0;
int P6=0;
int P7=0;
int P8=0;
int P9=0;
int P10=0;
//KONIEC ZMIENNYCH TEMP

//ZMIENNA POLOZENIA
int POLOZENIE=666;
int NUMER=69;
int NUMER2=76;
int NUMER3=69;
int STOP=0;
//KONIEC ZMIENNEJ POLOZENIA

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC ZMIENNYCH////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int WYSLANO_0=0;
int WYSLANO_1=0;
int WYSLANO_2=0;
int WYSLANO_3=0;
int WYSLANO_4=0;
int WYSLANO_5=0;
int WYSLANO_6=0;
int WYSLANO_7=0;
int WYSLANO_8=0;
int WYSLANO_9=0;
int WYSLANO_10=0;

int OP_STOP=10;
int SKOK=0;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//POLECENIA SPI////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void SPI_MasterInit(void)
{
	/* Set MOSI and SCK output, all others input */
	DDR_SPI = (1<<DD_MOSI)|(1<<DD_SCK)|(1<<DD_SS);
	/* Enable SPI, Master, set clock rate fck/16 */
	SPCR = (1<<SPE)|(1<<MSTR)|(1<<SPR0)|(1<<SPR1);
}
void SPI_MasterTransmit(int cData)
{
	/* Start transmission */
	SPDR = cData;
	/* Wait for transmission complete */
	while(!(SPSR & (1<<SPIF)))
	;
}
void SPI_SlaveInit(void)
{
	/* Set MISO output, all others input */
	DDR_SPI = (1<<DD_MISO);//|(1<<DD_SS);|(1<<DD_SS);
	/* Enable SPI */
	SPCR = (1<<SPE);//|(1<<SPR0)|(1<<SPR1)
}

int SPI_SlaveReceive(void)
{
	/* Wait for reception complete */
	while(!(SPSR & (1<<SPIF)))
	;
	/* Return data register */
	return SPDR;
}


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC POLECEN SPI////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//GLOWNY PROGRAM//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int main(void)
{

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//INICJALIZACJA MCU///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//WYLACZENIE JTAG
MCUCSR |= (1<<JTD); 
MCUCSR |= (1<<JTD); 
//KONIEC WYLACZENIA JTAG

//USTAWIENIE REJESTROW
DDRA=0x00;			//0x06
DDRB=0x00;
DDRC=0x3f;			//DDRC=0x3f;
DDRD=0xf8;			//DDRD=0xf8;
//KONIEC USTAWIENIA REJESTROW

//USTAWIENIE PORTOW
PORTA=0x00;
PORTB=0x00;
PORTC=0x00;
PORTD=0x00;
//KONIEC USTAWIENIA PORTOW

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC INICJALIZACJI MCU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

czekaj(100);

SPI_SlaveInit(); //INICJALIZACJA SPI

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//SPRAWDZENIE STANOW WEJSC////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int SPRAWDZENIE_STANOW_WEJSC(void)
{
	if(PINB &0x01){PIETRO_0_WEJSCIE=1;}
	if(!(PINB &0x01)){PIETRO_0_WEJSCIE=0;}

	if(PINB &0x02){PIETRO_1_WEJSCIE=1;}
	if(!(PINB &0x02)){PIETRO_1_WEJSCIE=0;}

	if(PINB &0x04){PIETRO_2_WEJSCIE=1;}
	if(!(PINB &0x04)){PIETRO_2_WEJSCIE=0;}

	if(PINB &0x08){PIETRO_3_WEJSCIE=1;}
	if(!(PINB &0x08)){PIETRO_3_WEJSCIE=0;}

	if(PINA &0x01){PIETRO_4_WEJSCIE=1;}
	if(!(PINA &0x01)){PIETRO_4_WEJSCIE=0;}

	if(PINA &0x02){PIETRO_5_WEJSCIE=1;}
	if(!(PINA &0x02)){PIETRO_5_WEJSCIE=0;}

	if(PINA &0x04){PIETRO_6_WEJSCIE=1;}
	if(!(PINA &0x04)){PIETRO_6_WEJSCIE=0;}

	if(PINA &0x08){PIETRO_7_WEJSCIE=1;}
	if(!(PINA &0x08)){PIETRO_7_WEJSCIE=0;}

	if(PIND &0x01){PIETRO_8_WEJSCIE=1;}
	if(!(PIND &0x01)){PIETRO_8_WEJSCIE=0;}

	if(PIND &0x02){PIETRO_9_WEJSCIE=1;}
	if(!(PIND &0x02)){PIETRO_9_WEJSCIE=0;}

	if(PIND &0x04){PIETRO_10_WEJSCIE=1;}
	if(!(PIND &0x04)){PIETRO_10_WEJSCIE=0;}

	return(0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIECSPRAWDZENIA STANOW WEJSC//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//USTAWIENIE STANOW WYJSC/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int RESET_WYJSC_I_WEJSC()
{
	if(PIND &0x08){PORTD=PORTD^0x08;PIETRO_0_WYJSCIE=0;}
	if(PIND &0x10){PORTD=PORTD^0x10;PIETRO_1_WYJSCIE=0;}
	if(PIND &0x20){PORTD=PORTD^0x20;PIETRO_2_WYJSCIE=0;}
	if(PIND &0x40){PORTD=PORTD^0x40;PIETRO_3_WYJSCIE=0;}
	if(PIND &0x80){PORTD=PORTD^0x80;PIETRO_4_WYJSCIE=0;}
	if(PINC &0x01){PORTC=PORTC^0x01;PIETRO_5_WYJSCIE=0;}
	if(PINC &0x02){PORTC=PORTC^0x02;PIETRO_6_WYJSCIE=0;}
	if(PINC &0x04){PORTC=PORTC^0x04;PIETRO_7_WYJSCIE=0;}
	if(PINC &0x08){PORTC=PORTC^0x08;PIETRO_8_WYJSCIE=0;}
	if(PINC &0x10){PORTC=PORTC^0x10;PIETRO_9_WYJSCIE=0;}
	if(PINC&0x20){PORTC=PORTC^0x20;PIETRO_10_WYJSCIE=0;}

	return(0);
}

int RESET_WYJSC()
{
	PORTD=PORTD^0x08;
	PORTD=PORTD^0x10;
	PORTD=PORTD^0x20;
	PORTD=PORTD^0x40;
	PORTD=PORTD^0x80;
	PORTC=PORTC^0x01;
	PORTC=PORTC^0x02;
	PORTC=PORTC^0x04;
	PORTC=PORTC^0x08;
	PORTC=PORTC^0x10;
	PORTC=PORTC^0x20;

	return(0);
}

int SKR_USTAWIENIE_STANOW_WYJSC(void)
{
	if(PIETRO_0_WYJSCIE==0) {if(PIND &0x08){PORTD=PORTD^0x08;}}//
	if(PIETRO_1_WYJSCIE==0) {if(PIND &0x10){PORTD=PORTD^0x10;}}//
	if(PIETRO_2_WYJSCIE==0) {if(PIND &0x20){PORTD=PORTD^0x20;}}//
	if(PIETRO_3_WYJSCIE==0) {if(PIND &0x40){PORTD=PORTD^0x40;}}//
	if(PIETRO_4_WYJSCIE==0) {if(PIND &0x80){PORTD=PORTD^0x80;}}//
	if(PIETRO_5_WYJSCIE==0) {if(PINC &0x01){PORTC=PORTC^0x01;}}//
	if(PIETRO_6_WYJSCIE==0) {if(PINC &0x02){PORTC=PORTC^0x02;}}//
	if(PIETRO_7_WYJSCIE==0) {if(PINC &0x04){PORTC=PORTC^0x04;}}//
	if(PIETRO_8_WYJSCIE==0) {if(PINC &0x08){PORTC=PORTC^0x08;}}//
	if(PIETRO_9_WYJSCIE==0) {if(PINC &0x10){PORTC=PORTC^0x10;}}//
	if(PIETRO_10_WYJSCIE==0){if(PINC&0x20){PORTC=PORTC^0x20;}}//

	return(0);
}


int USTAWIENIE_STANOW_WYJSC(void)
{
	if(PIETRO_0_WYJSCIE==0) {if(PIND &0x08){PORTD=PORTD^0x08;}}//
	if(PIETRO_1_WYJSCIE==0) {if(PIND &0x10){PORTD=PORTD^0x10;}}//
	if(PIETRO_2_WYJSCIE==0) {if(PIND &0x20){PORTD=PORTD^0x20;}}//
	if(PIETRO_3_WYJSCIE==0) {if(PIND &0x40){PORTD=PORTD^0x40;}}//
	if(PIETRO_4_WYJSCIE==0) {if(PIND &0x80){PORTD=PORTD^0x80;}}//
	if(PIETRO_5_WYJSCIE==0) {if(PINC &0x01){PORTC=PORTC^0x01;}}//
	if(PIETRO_6_WYJSCIE==0) {if(PINC &0x02){PORTC=PORTC^0x02;}}//
	if(PIETRO_7_WYJSCIE==0) {if(PINC &0x04){PORTC=PORTC^0x04;}}//
	if(PIETRO_8_WYJSCIE==0) {if(PINC &0x08){PORTC=PORTC^0x08;}}//
	if(PIETRO_9_WYJSCIE==0) {if(PINC &0x10){PORTC=PORTC^0x10;}}//
	if(PIETRO_10_WYJSCIE==0){if(PINC&0x20){PORTC=PORTC^0x20;}}//

	if(PIETRO_0_WEJSCIE==1) {PORTD=PORTD|0x08;PIETRO_0_WYJSCIE=1;P0=1;}
	if(PIETRO_1_WEJSCIE==1) {PORTD=PORTD|0x10;PIETRO_1_WYJSCIE=1;P1=1;}
	if(PIETRO_2_WEJSCIE==1) {PORTD=PORTD|0x20;PIETRO_2_WYJSCIE=1;P2=1;}
	if(PIETRO_3_WEJSCIE==1) {PORTD=PORTD|0x40;PIETRO_3_WYJSCIE=1;P3=1;}
	if(PIETRO_4_WEJSCIE==1) {PORTD=PORTD|0x80;PIETRO_4_WYJSCIE=1;P4=1;}
	if(PIETRO_5_WEJSCIE==1) {PORTC=PORTC|0x01;PIETRO_5_WYJSCIE=1;P5=1;}
	if(PIETRO_6_WEJSCIE==1) {PORTC=PORTC|0x02;PIETRO_6_WYJSCIE=1;P6=1;}
	if(PIETRO_7_WEJSCIE==1) {PORTC=PORTC|0x04;PIETRO_7_WYJSCIE=1;P7=1;}
	if(PIETRO_8_WEJSCIE==1) {PORTC=PORTC|0x08;PIETRO_8_WYJSCIE=1;P8=1;}
	if(PIETRO_9_WEJSCIE==1) {PORTC=PORTC|0x10;PIETRO_9_WYJSCIE=1;P9=1;}
	if(PIETRO_10_WEJSCIE==1){PORTC=PORTC|0x20;PIETRO_10_WYJSCIE=1;P10=1;}

	return(0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC USTAWIENIA STANOW WYJSC/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//GLOWNA PETLA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
while(1)
{
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//SEKCJA SPI////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	SPRAWDZENIE_STANOW_WEJSC();
	USTAWIENIE_STANOW_WYJSC();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//SPRAWDZENIE PRZELACZNIKA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	if(PIETRO_0_WEJSCIE==0&&PIETRO_0_WYJSCIE==1){STOP=1;PIETRO_0_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_1_WEJSCIE==0&&PIETRO_1_WYJSCIE==1){STOP=1;PIETRO_1_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_2_WEJSCIE==0&&PIETRO_2_WYJSCIE==1){STOP=1;PIETRO_2_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_3_WEJSCIE==0&&PIETRO_3_WYJSCIE==1){STOP=1;PIETRO_3_WYJSCIE=0;RESET_WYJSC();}

	if(PIETRO_4_WEJSCIE==0&&PIETRO_4_WYJSCIE==1){STOP=1;PIETRO_4_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_5_WEJSCIE==0&&PIETRO_5_WYJSCIE==1){STOP=1;PIETRO_5_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_6_WEJSCIE==0&&PIETRO_6_WYJSCIE==1){STOP=1;PIETRO_6_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_7_WEJSCIE==0&&PIETRO_7_WYJSCIE==1){STOP=1;PIETRO_7_WYJSCIE=0;RESET_WYJSC();}

	if(PIETRO_8_WEJSCIE==0&&PIETRO_8_WYJSCIE==1){STOP=1;PIETRO_8_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_9_WEJSCIE==0&&PIETRO_9_WYJSCIE==1){STOP=1;PIETRO_9_WYJSCIE=0;RESET_WYJSC();}
	if(PIETRO_10_WEJSCIE==0&&PIETRO_10_WYJSCIE==1){STOP=1;PIETRO_10_WYJSCIE=0;RESET_WYJSC();}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC SPRAWDZENIA PRZELACZNIKA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	SKOK+=1;
	if(PIETRO_0_WEJSCIE+PIETRO_1_WEJSCIE+PIETRO_2_WEJSCIE+PIETRO_3_WEJSCIE+PIETRO_4_WEJSCIE+PIETRO_5_WEJSCIE
	+PIETRO_6_WEJSCIE+PIETRO_7_WEJSCIE+PIETRO_8_WEJSCIE+PIETRO_9_WEJSCIE+PIETRO_10_WEJSCIE==0){NUMER2=0;}
	if(PIETRO_0_WYJSCIE+PIETRO_0_WEJSCIE>=1&&WYSLANO_0==0&&SKOK==1){NUMER2=1;}
	if(PIETRO_1_WYJSCIE+PIETRO_1_WEJSCIE>=1&&WYSLANO_1==0&&SKOK==2){NUMER2=2;}
	if(PIETRO_2_WYJSCIE+PIETRO_2_WEJSCIE>=1&&WYSLANO_2==0&&SKOK==3){NUMER2=3;}
	if(PIETRO_3_WYJSCIE+PIETRO_3_WEJSCIE>=1&&WYSLANO_3==0&&SKOK==4){NUMER2=4;}
	if(PIETRO_4_WYJSCIE+PIETRO_4_WEJSCIE>=1&&WYSLANO_4==0&&SKOK==5){NUMER2=5;}
	if(PIETRO_5_WYJSCIE+PIETRO_5_WEJSCIE>=1&&WYSLANO_5==0&&SKOK==6){NUMER2=6;}
	if(PIETRO_6_WYJSCIE+PIETRO_6_WEJSCIE>=1&&WYSLANO_6==0&&SKOK==7){NUMER2=7;}
	if(PIETRO_7_WYJSCIE+PIETRO_7_WEJSCIE>=1&&WYSLANO_7==0&&SKOK==8){NUMER2=8;}
	if(PIETRO_8_WYJSCIE+PIETRO_8_WEJSCIE>=1&&WYSLANO_8==0&&SKOK==9){NUMER2=9;}
	if(PIETRO_9_WYJSCIE+PIETRO_9_WEJSCIE>=1&&WYSLANO_9==0&&SKOK==10){NUMER2=10;}
	if(PIETRO_10_WYJSCIE+PIETRO_10_WEJSCIE>=1&&WYSLANO_10==0&&SKOK==11){NUMER2=11;}
	if(SKOK==11){SKOK=0;}
	czekaj(5);
	NUMER=SPI_SlaveReceive();
	czekaj(5);
	if(STOP==1){OP_STOP-=1;NUMER2=201;if(OP_STOP<1){STOP=0;OP_STOP=10;}}
	czekaj(5);

	if(NUMER==169){RESET_WYJSC_I_WEJSC();}

	if(NUMER==1 ){PIETRO_0_WYJSCIE=0;PIETRO_0_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==2 ){PIETRO_1_WYJSCIE=0;PIETRO_1_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==3 ){PIETRO_2_WYJSCIE=0;PIETRO_2_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==4 ){PIETRO_3_WYJSCIE=0;PIETRO_3_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==5 ){PIETRO_4_WYJSCIE=0;PIETRO_4_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==6 ){PIETRO_5_WYJSCIE=0;PIETRO_5_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==7 ){PIETRO_6_WYJSCIE=0;PIETRO_6_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==8 ){PIETRO_7_WYJSCIE=0;PIETRO_7_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==9 ){PIETRO_8_WYJSCIE=0;PIETRO_8_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==10){PIETRO_9_WYJSCIE=0;PIETRO_9_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
	if(NUMER==11){PIETRO_10_WYJSCIE=0;PIETRO_10_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}

	if(NUMER==190){PIETRO_10_WYJSCIE=1;PIETRO_10_WEJSCIE=1;USTAWIENIE_STANOW_WYJSC();}
	if(NUMER==191){PIETRO_0_WYJSCIE=1;PIETRO_0_WEJSCIE=1;USTAWIENIE_STANOW_WYJSC();}

	czekaj(5);

	SPI_MasterTransmit(NUMER2);
	czekaj(5);

/*
if(NUMER==11){PIETRO_10_WYJSCIE=0;PIETRO_10_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==10){PIETRO_9_WYJSCIE=0;PIETRO_9_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==9 ){PIETRO_8_WYJSCIE=0;PIETRO_8_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==8 ){PIETRO_7_WYJSCIE=0;PIETRO_7_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==7 ){PIETRO_6_WYJSCIE=0;PIETRO_6_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==6 ){PIETRO_5_WYJSCIE=0;PIETRO_5_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==5 ){PIETRO_4_WYJSCIE=0;PIETRO_4_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==4 ){PIETRO_3_WYJSCIE=0;PIETRO_3_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==3 ){PIETRO_2_WYJSCIE=0;PIETRO_2_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==2 ){PIETRO_1_WYJSCIE=0;PIETRO_1_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
if(NUMER==1 ){PIETRO_0_WYJSCIE=0;PIETRO_0_WEJSCIE=0;NUMER=0;SKR_USTAWIENIE_STANOW_WYJSC();NUMER2=0;}
*/

}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC GLOWNEJ PETLI////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//KONIEC GLOWNEGO PROGRAMU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////